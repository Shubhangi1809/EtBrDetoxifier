{% load static %}
<!DOCTYPE html>
<html>
<head>
	<!-- Basic Page Info -->
	<meta charset="utf-8">
	<title>EtBr Dashboard </title>

	<!-- Site favicon -->
	<link rel="apple-touch-icon" sizes="180x180" href='{% static "vendors/images/apple-touch-icon.png" %}'>
	<link rel="icon" type="image/png" sizes="32x32" href='{% static "vendors/images/favicon-32x32.png" %}'>
	<link rel="icon" type="image/png" sizes="16x16" href='{% static "vendors/images/favicon-16x16.png" %}'>

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- Google Font -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<!-- CSS -->
	<link rel="stylesheet" type="text/css" href='{% static "vendors/styles/core.css" %}'>
	<link rel="stylesheet" type="text/css" href='{% static "vendors/styles/icon-font.min.css" %}'>
	<link rel="stylesheet" type="text/css" href='{% static "vendors/styles/style.css" %}'>
	<link rel="stylesheet" type="text/css" href='{% static "src/styles/style.css" %}'>
	<link rel="stylesheet" type="text/css" href='{% static "src/styles/reports.css" %}'>


	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-119386393-1"></script>
	<!-- <script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'UA-119386393-1');
	</script> -->
	<script src="http://www.amcharts.com/lib/3/amcharts.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/serial.js" type="text/javascript"></script>
<script src="http://www.amcharts.com/lib/3/amstock.js" type="text/javascript"></script>
	<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>
<style>
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}
th {
  text-align: center;
}
td {
font-size:15px;
}
tr:nth-child(even) {
  background-color: #dddddd;
}
chartdiv {
  width: 100%;
  height: 500px;
}
.chart {
  width: 100%;
  height: 500px;
}

</style>
</head>
<body>
	<!-- <div class="pre-loader">
		<div class="pre-loader-box">

			<div>
				<h5 class="loading">Holistic Asthma Management Solution</h5>
			</div>
			<div class='loader-progress' id="progress_div">
				<div class='bar' id='bar1'></div>
			</div>
			<div class='percent' id='percent1'>0%</div>
		</div>
	</div> -->

	<div class="header">
		<div class="header-left">

            <div>
            	<button class="btn btn-primary rating">Rating &#128512</button>
            </div>

		</div>
			<div class="header-right">
			<div class="user-notification">
				<div class="dropdown">
					<a class="dropdown-toggle no-arrow" href="#" role="button" data-toggle="dropdown">
						<i class="icon-copy dw dw-notification"></i>
						<span class="badge notification-active"></span>
					</a>
					<div class="dropdown-menu dropdown-menu-right">
						<div class="notification-list mx-h-350 customscroll">
							<ul>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/img.jpg" %}' alt="">
										<h3>John Doe</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/photo1.jpg" %}' alt="">
										<h3>Lea R. Frith</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/photo2.jpg" %}' alt="">
										<h3>Erik L. Richards</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/photo3.jpg" %}' alt="">
										<h3>John Doe</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/photo4.jpg" %}' alt="">
										<h3>Renee I. Hansen</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
								<li>
									<a href="#">
										<img src='{% static "vendors/images/img.jpg" %}' alt="">
										<h3>Vicki M. Coleman</h3>
										<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed...</p>
									</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>


		<div class="reload">
            <a href="" onclick="return locationreload();"><i class="icon-copy ion-ios-loop" aria-hidden="true"></i></a>

		</div>
			<div class="user-info-dropdown">
				<div class="dropdown">
					<a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">
						<span class="user-icon">
							<img src='{% static "vendors/images/photo1.jpeg" %}' alt="">
						</span>
						<span class="user-name">Padmanabh BV</span>
					</a>
					<div class="dropdown-menu dropdown-menu-right dropdown-menu-icon-list">
						<a class="dropdown-item" href="{% url 'EtBr-profile' %}"><i class="dw dw-user1"></i> Profile</a>
						<a class="dropdown-item" href="{% url 'EtBr-help' %}"><i class="dw dw-help"></i> Help</a>
						<a class="dropdown-item" href="{% url 'EtBr-login' %}"><i class="dw dw-logout"></i> Log Out</a>
					</div>
				</div>
			</div>
			<div class="github-link">
				<a href="https://github.com/dropways/deskapp" target="_blank"><img src='{% static "vendors/images/github.svg" %}' alt=""></a>
			</div>
		</div>
	</div>


	<div class="left-side-bar">
		<div class="brand-logo">
			<a href="{% url 'EtBr-index' %}">
				<!-- <img src="vendors/images/deskapp-logo.svg" alt="" class="dark-logo">
				<img src="vendors/images/deskapp-logo-white.svg" alt="" class="light-logo"> -->
			<h4 class="dashboard-title">EtBr Dashboard</h4>
			</a>
			<div class="close-sidebar" data-toggle="left-sidebar-close">
				<i class="ion-close-round"></i>
			</div>
		</div>
		<div class="menu-block customscroll">
			<div class="sidebar-menu">
				<ul id="accordion-menu">
					<li>

						<a href="{% url 'EtBr-index' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-house-1"></span><span class="mtext">Home</span>
						</a>

					</li>
					<li>
					 <a href="{% url 'EtBr-profile' %}" class="dropdown-toggle no-arrow">
					    <span class="micon dw dw-user1"></span><span class="mtext">Profile</span>
					</a>
					</li>
					<li>
						<a href="{% url 'EtBr-reports' %}" class="dropdown-toggle no-arrow">
							<span class="micon dw dw-file"></span><span class="mtext">Reports</span>
						</a>
					</li>
					</ul>
			</div>
		</div>
	</div>
	<div class="mobile-menu-overlay"></div>

	<div class="main-container">
		<div class="pd-ltr-20 xs-pd-20-10">
			<div class="min-height-200px">
				<div class="page-header">
					<div class="row">
						<div class="col-md-6 col-sm-12">
							<div class="title">
								<h4>Reports</h4>
							</div>
							<nav aria-label="breadcrumb" role="navigation">
								<ol class="breadcrumb">
									<li class="breadcrumb-item"><a href="index">Home</a></li>
									<li class="breadcrumb-item active" aria-current="page">Reports</li>
								</ol>
							</nav>
						</div>
					</div>
				</div>
				<div class="row">
				<div class="col-lg-12 col-md-12 col-sm-12 mb-30">
					<div class="card-box pd-30 height-100-p">
						<div class="chat-profile-header clearfix">
									<div class="left">
										<div class="clearfix">
											<div class="chat-profile-name">
												<h4 class="">Report</h4>
											</div>
										</div>
									</div>
									<div class="right text-right">
										<div class="dropdown">
											<a class="btn btn-outline-primary dropdown-toggle" href="#" role="button" data-toggle="dropdown">
												Export
											</a>
											<div class="dropdown-menu dropdown-menu-right">
												<a class="dropdown-item" href="#">CSV</a>
												<a class="dropdown-item" href="#">PDF</a>
											</div>
										</div>
									</div>
								</div>
						<table>

  <tr>
    <th style="width:20%">CreatedAt</th>
    <th style="width:8%">Key</th>
    <th style="width:8%">MAC_ID</th>
    <th style="width:8%">Device</th>
    <th style="width:8%">Username</th>
	<th style="width:2%">Temperature</th>
	<th style="width:8%">pHin</th>
	<th style="width:8%">TDSin</th>
	<th style="width:8%">pHout</th>
	<th style="width:8%">TDSout</th>
	<th style="width:5%">MotorONInSeconds</th>
	<th style="width:5%">VolumeSampled</th>
	<th style="width:5%">NoOfHourUsed</th>
	<th style="width:5%">CartridgeLifeLeft</th>
  </tr>
   {% for Test in query_result %}
        <tr>
            <td>{{Test.CreatedAt}}</td>
            <td>{{Test.Key}}</td>
            <td>{{Test.MAC_ID}}</td>
            <td>{{Test.Device}}</td>
            <td>{{Test.Username}}</td>
			<td>{{Test.Temperature}}</td>
			<td>{{Test.pHin}}</td>
			<td>{{Test.TDSin}}</td>
			<td>{{Test.pHout}}</td>
			<td>{{Test.TDSout}}</td>
			<td>{{Test.MotorONInSeconds}}</td>
			<td>{{Test.VolumeSampled}}</td>
			<td>{{Test.NoOfHourUsed}}</td>
			<td>{{Test.CartridgeLifeLeft}}</td>


        </tr>
    {% endfor %}
</table>
				<div class="row">
				<div class="col-lg-12 col-md-12 col-sm-12 mb-30">
					<div class="card-box pd-30 height-100-p">
						<h4>Chart</h4>

						<div id="chartdiv" style="width: 100%; height: 355px; margin-top: 25px;"></div>

					</div>
				</div>

            <div class="col-12 mb-40">
                <div class="card-box pd-20 height-90-p mb-30">
				<h4>Temperature</h4>
                    <div id="temp_chart" class="chart"></div>

                </div>
            </div>
            <div class="col-12 mb-40">
                <div class="card-box pd-20 height-90-p mb-30">
				<h4>TDSin</h4>
                    <div id="tdsin_chart" class="chart"></div>

                </div>
            </div>
            <div class="col-12 mb-40">
                <div class="card-box pd-20 height-90-p mb-30">
				<h4>TDSout</h4>
                    <div id="tdsout_chart" class="chart"></div>

                </div>
            </div>

        </div>
			</div>
			</div>
			</div>
		</div>

		<!-- js -->

	<script src='{% static "vendors/scripts/core.js" %}'></script>
	<script src='{% static "vendors/scripts/script.min.js" %}'></script>
	<script src='{% static "vendors/scripts/process.js" %}'></script>
	<script src='{% static "vendors/scripts/layout-settings.js" %}'></script>
	<script src="{% static 'src/scripts/chatsLine.js' %}"></script>
	<script>

const data = {{query_results_json |safe}};

  am4core.ready(function() {
        generateDateLineChart('temp_chart', data, 'Temperature');
        generateDateLineChart('tdsin_chart', data, 'TDSin');
        generateDateLineChart('tdsout_chart', data, 'TDSout');
    })

am4core.ready(function() {

// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end

// Create chart instance
var chart = am4core.create("chartdiv", am4charts.XYChart);

//

// Increase contrast by taking evey second color
chart.colors.step = 2;

// Add data
chart.data = generateChartData();


// Create axes
var dateAxis = chart.xAxes.push(new am4charts.DateAxis());
dateAxis.renderer.minGridDistance = 50;
dateAxis.baseInterval = {
  "timeUnit": "second",
  "count": 1
}

// Create series
function createAxisAndSeries(field, name, opposite) {
  var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
  if(chart.yAxes.indexOf(valueAxis) != 0){
  	valueAxis.syncWithAxis = chart.yAxes.getIndex(0);
  }

  var series = chart.series.push(new am4charts.LineSeries());
  series.dataFields.valueY = field;
  series.dataFields.dateX = "date";
  series.strokeWidth = 2;
  series.yAxis = valueAxis;
  series.name = name;
  series.tooltipText = "{name}: [bold]{valueY}[/]";
  series.tensionX = 0.8;
  series.showOnInit = true;

  var interfaceColors = new am4core.InterfaceColorSet();

  var bullet = series.bullets.push(new am4charts.CircleBullet());
      bullet.circle.stroke = interfaceColors.getFor("background");
      bullet.circle.strokeWidth = 2;

  valueAxis.renderer.line.strokeOpacity = 1;
  valueAxis.renderer.line.strokeWidth = 2;
  valueAxis.renderer.line.stroke = series.stroke;
  valueAxis.renderer.labels.template.fill = series.stroke;
  valueAxis.renderer.opposite = opposite;
}


createAxisAndSeries('temp', 'temp', false);
createAxisAndSeries('pHin', 'pHin', false);
createAxisAndSeries('pHout', 'pHout', false);
createAxisAndSeries('TDSin', 'TDSin', false);
createAxisAndSeries('TDSout', 'TDSout', false);

// Add legend
chart.legend = new am4charts.Legend();

// Add cursor
chart.cursor = new am4charts.XYCursor();

// generate some random data, quite different range
function generateChartData() {

    const chartData = [];

    data.forEach(obj => {
        const data = {
            date: Date.parse(obj.fields.CreatedAt),
            pHin: obj.fields.pHin,
            pHout: obj.fields.pHout,
            TDSin:  obj.fields.TDSin,
            TDSout: obj.fields.TDSout
        };
        chartData.push(data);
    });
    return chartData;
}

});
</script>
</body>
</html>